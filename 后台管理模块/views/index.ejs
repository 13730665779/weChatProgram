<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <script src="js/jquery.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.min.css" />
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="http://cdn.bootcss.com/jquery/1.11.1/jquery.min.js"></script>
    <title>自然风光主题酒店</title>
    <style>
        .header{
            width: 100%;
            display: inline-block;
            margin: 10px auto;
            height: 50px;
            background-color: #bce8f1;
            line-height: 50px;
        }

        .HomeInfor{
            display: none;
        }

        .foodInfor{
            display: none;
        }
        .EntertainmentInfor{
            display: none;
        }

        .hostelImg{
            width: 60px;
            height: 60px;
        }
        .searchRoom{
            margin-left: 40%;
        }

        .search_roombtn{
            margin-left: 56%;
            margin-top: -51px;
        }

        .hiden {
            display: none;
        }
    </style>
    <script>
        $(function () {
            $(".nav_tab").click(function () {
                if(!$(this).hasClass('active')){
                    $(this).addClass('active');
                    $(this).siblings().removeClass('active');
                }
                if($(this).hasClass('nav_tab01')){
                    $('.StyleInfor').show();
                    $('.HomeInfor').hide();
                    $('.foodInfor').hide();
                    $('.EntertainmentInfor').hide();
                }
                else if($(this).hasClass('nav_tab02')){
                    $('.HomeInfor').show();
                    $('.StyleInfor').hide();
                    $('.foodInfor').hide();
                    $('.EntertainmentInfor').hide();
                }
                else if($(this).hasClass('nav_tab03')){
                    $('.foodInfor').show();
                    $('.StyleInfor').hide();
                    $('.HomeInfor').hide();
                    $('.EntertainmentInfor').hide();
                }
                else if($(this).hasClass('nav_tab04')){
                    $('.EntertainmentInfor').show();
                    $('.foodInfor').hide();
                    $('.StyleInfor').hide();
                    $('.HomeInfor').hide();
                }
            });

            $(".search_roombtn").click(function () {
                var trList = $(".roomTbody").children("tr");
                var trLength = trList.length;
                for (var i = 0; i < trLength; i++) {
                    var tdArr = trList.eq(i).find("td");
                    var tdRoomNo = tdArr.eq(1).text();
                    var tdRoomTheme = tdArr.eq(2).text();
                    var tdRoomAccomondate = tdArr.eq(3).text();
                    var tdRoomPrice = tdArr.eq(4).text();
                    var inputRoomSearch = $("#inputRoomSearch").val();
                    if (tdRoomNo.match(inputRoomSearch) || tdRoomTheme.match(inputRoomSearch) || tdRoomAccomondate.match(inputRoomSearch) || tdRoomPrice.match(inputRoomSearch)) {
                        trList.eq(i).show();
                    } else {
                        trList.eq(i).hide();
                    }
                }
            });

            $('.updata_room').click(function () {
                var id = this.getAttribute('id');
                $("#"+id).children().removeClass('hiden');
                $("#"+id).children().focus();
            })
            $('.updata_room').dblclick(function () {
                var tdId = this.getAttribute('id');
                if(tdId.match("ThemeId")){
                    tdName = "themeId";
                }
                else if(tdId.match("Accommodate")){
                    tdName = "accommodate";
                }
                if(tdId.match("RoomPrice")){
                    tdName = "roomPrice";
                }
                var tr = $("#"+tdId).parent();
                if($("#"+tdId).children().val().length>0){
                    var data = "id="+tr.attr('id')+"&name="+tdName+"&value="+$("#"+tdId).children().val();
                    var ThemeHttp=new XMLHttpRequest();
                    ThemeHttp.open('POST',"http://localhost:8883/updateRoom",true);
                    ThemeHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
                    ThemeHttp.send(data);
                }
                $("#"+tdId).children().addClass('hiden');
            })
        })


        // <!-- 风格管理/保存-->
        function  saveTheme() {
            var inputThemeForm = document.getElementById("inputThemeForm");
            var file = document.getElementById("inputImgKey");
            var formData = new FormData(inputThemeForm);
            var fileObj =file.files[0];
            formData.append("uploadImage", fileObj);
            var url = "http://localhost:8883/upload";
            // var ThemeHttp=new XMLHttpRequest();
            // ThemeHttp.open('POST',url,true);
            // ThemeHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            // ThemeHttp.send(formData);
            <!--封装好的Ajax-->
            $.ajax({
                url: url,
                type: 'POST',
                data: formData,

                /**
                 * 必须false才会避开jQuery对 formdata 的默认处理
                 * XMLHttpRequest会对 formdata 进行正确的处理
                 */
                processData: false,
                /**
                 *必须false才会自动加上正确的Content-Type
                 */
                contentType: false,
                success: function (responseStr) {
                    alert(responseStr.newPath);

                },
                error: function (responseStr) {
                    alert(responseStr.newPath);
                }
            });

            // ThemeHttp.onreadystatechange=function () {
            //     if (ThemeHttp.readyState==4 && ThemeHttp.status==200){
            //         console.log(ThemeHttp);
            //         // var result =JSON.parse(ThemeHttp.responseText);
            //         // // console.log(result);
            //         // if(result.ok==1){
            //         //     window.location.href='http://localhost:8882/index';
            //         // }
            //     }
        //   }
        }
        <!-- 风格管理/保存-->
        function deleteTheme(erg){
            // var roomNo=document.getElementsByClassName('roomNo');
            var themeId=erg.value;
            var url="http://localhost:8883/deleteTheme";
            data="themeId="+themeId;
            console.log(themeId);
            var deleteThemeHttp = new XMLHttpRequest();
            deleteThemeHttp.open('post',url,true);
            deleteThemeHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            deleteThemeHttp.send(data);
        }
        <!-- 房间管理/保存-->
        function saveRoom(){
            var inputRoomNo = document.getElementById('inputRoomNo');
            var inputThemeName=document.getElementById('inputTheme');
            var inputAccomodate=document.getElementById('inputAccomodate');
            var inputRoomPrice=document.getElementById('inputRoomPrice');
            var roomNo=inputRoomNo.value;
            var index=inputThemeName.selectedIndex;
            var themeName=inputThemeName.options[index].text;
            var accomodate=inputAccomodate.value;
            var roomPrice=inputRoomPrice.value;
            data="roomNo="+roomNo+"&themeName="+themeName+"&accomodate="+accomodate+"&roomPrice="+roomPrice;
            console.log(data);
            var url="http://localhost:8883/addRoom";
            var roomHttp=new XMLHttpRequest();
            roomHttp.open('POST',url,true);
            roomHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            roomHttp.send(data);
        }
        <!-- 房间管理/删除-->
        function deleteRoom(erg){
            // var roomNo=document.getElementsByClassName('roomNo');
            var roomNo=erg.value;
            var url="http://localhost:8883/deleteRoom";
            data="roomNo="+roomNo;
            var deleteRoomHttp = new XMLHttpRequest();
            deleteRoomHttp.open('post',url,true);
            deleteRoomHttp.setRequestHeader("Content-type","application/x-www-form-urlencoded");
            deleteRoomHttp.send(data);
        }
    </script>
</head>
<body>
<div class="container">
    <h3 class="text-center header" >
        自然风光酒店
    </h3>
    <div class="row-fluid">
        <div class="span12">
            <ul class="nav nav-tabs">
                <li class="nav_tab  nav_tab01 active">
                    <a href="#">风格管理</a>
                </li>
                <li class="nav_tab  nav_tab02">
                    <a href="#">房间管理</a>
                </li>
                <li class="nav_tab nav_tab03">
                    <a href="#">餐饮</a>
                </li>
                <li class="nav_tab nav_tab04">
                    <a href="#">娱乐</a>
                </li>
                <li class="nav_tab nav_tab05">
                    <a href="#">其他</a>
                </li>
            </ul>
            <br>
            <!--风格管理-->
            <div class="StyleInfor">
                <form id="inputThemeForm" class="form-horizontal" action="/upload" >
                    <div class="control-group">
                        <label class="control-label" for="inputThemeName">风格名称</label>
                        <div class="controls">
                            <input id="inputThemeName" type="text" name="themeName" />
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputThemeInfor">描述</label>
                        <div class="controls">
                            <textarea  id="inputThemeInfor" name="themeInfor" placeholder="describe"></textarea>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputImgKey">图片</label>
                        <div class="controls">
                            <input id="inputImgKey" type="file" name="imgKey" />
                        </div>
                    </div>
                </form>
                <div class="control-group">
                    <div class="controls" style="margin-top: 10px">
                        <button  class="btn" onclick="saveTheme()">保存</button> <button class="btn">修改</button>
                    </div>
                </div>
                <br>
                <table class="table">
                    <thead>
                    <tr>
                        <th>
                            类型序号
                        </th>
                        <th>
                            风格名称
                        </th>
                        <th>
                            描述
                        </th>
                        <th>
                            图片
                        </th>
                        <th>
                            操作
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <% for (var i=0;i<themeData.length;i++){ %>
                    <tr>
                        <td>
                            <%=i+1%>
                        </td>
                        <td>
                            <%=themeData[i].themeName %>
                        </td>
                        <td>
                            <%=themeData[i].themeInfor %>
                        </td>
                        <td>
                           <img class="hostelImg" src="<%=themeData[i].imgKey %>" />
                        </td>
                        <td>
                            <button class="btn" onclick="deleteTheme(this)" value="<%=themeData[i].id %>">删除</button>
                        </td>
                    </tr>
                    <%} %>
                    </tbody>
                </table>
            </div>
            <!--房间管理-->
            <div class="HomeInfor">
                <form class="form-horizontal" action="/addRoom" method="post">
                    <div class="control-group">
                        <label class="control-label" for="inputRoomNo">房间编号</label>
                        <div class="controls">
                            <input id="inputRoomNo" type="text" name="roomNo" />
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputThemeName">房间风格</label>
                        <div class="controls">
                            <select name="inputThemeName" id="inputTheme">
                                <%for (var i=0;i<themeData.length;i++) {%>
                                <option value="<%=i %>"><%=themeData[i].themeName %></option>
                                <%}%>
                            </select>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputAccomodate">容纳人数</label>
                        <div class="controls">
                            <input  id="inputAccomodate" type="number" name="accomodate"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputRoomPrice">房间价格</label>
                        <div class="controls">
                            <input id="inputRoomPrice" type="text"  name="roomPrice"/>
                        </div>
                    </div>
                </form>
                <div class="control-group">
                    <div class="controls" style="margin-top: 10px">
                        <button  class="btn"  onclick="saveRoom()">保存</button>
                    </div>
                </div>
                <br>
                <form  class="form-search searchRoom" >
                    <input  class="input-medium search-query" id="inputRoomSearch" style="height: 32px;"  type="text" />
                </form>
                <button  class="btn search_roombtn" >搜索</button>

                <br>
                <table class="table">
                    <thead>
                    <tr>
                        <th>
                            房间编号
                        </th>
                        <th>
                            房间风格
                        </th>
                        <th>
                            容纳人数<span style="color:#ccc;">(可修改)</span>
                        </th>
                        <th>
                            价格<span style="color:#ccc;">(可修改)</span>
                        </th>
                        <th>
                            操作
                        </th>
                    </tr>
                    </thead>
                    <tbody class="roomTbody">
                    <%for(var i=0;i<roomData.length;i++){%>
                    <tr class="room_hidden" id="<%=roomData[i].id%>">
                        <td class="roomNo">
                            <%=roomData[i].roomNO %>
                        </td>
                        <td class="updata_room">
                            <%=roomData[i].themeId %>
                        </td>
                        <td class="updata_room" id="tdAccommodate<%=roomData[i].id%>">
                            <%=roomData[i].accommodate %>
                            <input type="text" class="hiden">
                        </td>
                        <td class="updata_room" id="tdroomPrice<%=roomData[i].id%>">
                            <%=roomData[i].roomPrice %>
                            <input type="text" class="hiden">
                        </td>
                        <td>
                        <button type="submit" class="btn" onclick="deleteRoom(this)" value="<%=roomData[i].roomNO %>">删除</button>
                        </td>
                    </tr>
                    <%} %>
                    </tbody>
                </table>
            </div>
            <!--餐饮-->
            <div class="foodInfor">
                <form class="form-horizontal">
                    <div class="control-group">
                        <label class="control-label" for="inputFoodNo">菜品序号</label>
                        <div class="controls">
                            <input id="inputFoodNo" type="text" name="foodNo"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputFoodName">菜品名称</label>
                        <div class="controls">
                            <input id="inputFoodName" type="text" name="foodName"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputFoodType">菜品种类</label>
                        <div class="controls">
                            <input  id="inputFoodType" type="text" name="foodType"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputFoodPrice">菜品价格</label>
                        <div class="controls">
                            <input id="inputFoodPrice" type="text" name="foodPrice"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputFoodInfo">菜品描述</label>
                        <div class="controls">
                            <input id="inputFoodInfo" type="text" name="foodInfo"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputFoodImgKey">菜品图片</label>
                        <div class="controls">
                            <input id="inputFoodImgKey" type="file" name="foodImgKey"/>
                        </div>
                    </div>
                </form>
                <div class="control-group">
                    <div class="controls" style="margin-top: 10px">
                        <button type="submit" class="btn">保存</button> <button class="btn" >修改</button> <button class="btn" >删除</button>
                    </div>
                </div>
                <br>
                <table class="table">
                    <thead>
                    <tr>
                        <th>
                            菜品序号
                        </th>
                        <th>
                            菜品名称
                        </th>
                        <th>
                            菜品种类
                        </th>
                        <th>
                            菜品价格
                        </th>
                        <th>
                            菜品描述
                        </th>
                        <th>
                            菜品图片
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>
                            1
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            01/04/2012
                        </td>
                        <td>
                            Default
                        </td>
                        <td>
                            1
                        </td>
                        <td>
                            1
                        </td>
                    </tr>
                    <tr class="success">
                        <td>
                            1
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            01/04/2012
                        </td>
                        <td>
                            Approved
                        </td>
                        <td>
                            1
                        </td>
                        <td>
                            1
                        </td>
                    </tr>
                    <tr class="error">
                        <td>
                            2
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            02/04/2012
                        </td>
                        <td>
                            Declined
                        </td>
                        <td>
                            1
                        </td>
                        <td>
                            1
                        </td>
                    </tr>
                    <tr class="warning">
                        <td>
                            3
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            03/04/2012
                        </td>
                        <td>
                            Pending
                        </td>
                        <td>
                            1
                        </td>
                        <td>
                            1
                        </td>
                    </tr>
                    <tr class="info">
                        <td>
                            4
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            04/04/2012
                        </td>
                        <td>
                            Call in to confirm
                        </td>
                        <td>
                            1
                        </td>
                        <td>
                            1
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
            <!--娱乐-->
            <div class="EntertainmentInfor">
                <form class="form-horizontal">
                    <div class="control-group">
                        <label class="control-label" for="inputEnterNo">娱乐设施序号</label>
                        <div class="controls">
                            <input id="inputEnterNo" type="text" name="EnterNo"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputEnterName">娱乐设施名称</label>
                        <div class="controls">
                            <input id="inputEnterName" type="text" name="enterName"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputEnterPlace">娱乐地点</label>
                        <div class="controls">
                            <input  id="inputEnterPlace" type="text" name="enterPlace"/>
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputEnterInfor">描述</label>
                        <div class="controls">
                            <input id="inputEnterInfor" type="text" name="enterInfor" />
                        </div>
                    </div>
                    <div class="control-group">
                        <label class="control-label" for="inputImgKey">图片</label>
                        <div class="controls">
                            <input id="inputImgKey" type="text" name="enterInfor" />
                        </div>
                    </div>
                    <div class="control-group">
                        <div class="controls" style="margin-top: 10px">
                            <button type="submit" class="btn">保存</button> <button type="submit" class="btn">修改</button> <button type="submit" class="btn">删除</button>
                        </div>
                    </div>
                </form>
                <br>
                <table class="table">
                    <thead>
                    <tr>
                        <th>
                            娱乐设施编号
                        </th>
                        <th>
                            娱乐设施名称
                        </th>
                        <th>
                            娱乐地点
                        </th>
                        <th>
                            描述
                        </th>
                        <th>
                            图片
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>
                            1
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            01/04/2012
                        </td>
                        <td>
                            Default
                        </td>
                        <td>
                            Approved
                        </td>
                    </tr>
                    <tr class="success">
                        <td>
                            1
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            01/04/2012
                        </td>
                        <td>
                            Approved
                        </td>
                        <td>
                            Approved
                        </td>
                    </tr>
                    <tr class="error">
                        <td>
                            2
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            02/04/2012
                        </td>
                        <td>
                            Declined
                        </td>
                        <td>
                            Approved
                        </td>
                    </tr>
                    <tr class="warning">
                        <td>
                            3
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            03/04/2012
                        </td>
                        <td>
                            Pending
                        </td>
                        <td>
                            Approved
                        </td>
                    </tr>
                    <tr class="info">
                        <td>
                            4
                        </td>
                        <td>
                            TB - Monthly
                        </td>
                        <td>
                            04/04/2012
                        </td>
                        <td>
                            Call in to confirm
                        </td>
                        <td>
                            Approved
                        </td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>

    </div>

</div>
</body>


</html>
